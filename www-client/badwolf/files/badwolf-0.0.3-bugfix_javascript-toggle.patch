From ab625a729cf4baa7ca1b22a6c1f2021cce8bf4ec Mon Sep 17 00:00:00 2001
From: "Haelwenn (lanodan) Monnier" <contact@hacktivis.me>
Date: Mon, 11 Mar 2019 10:05:51 +0100
Subject: [PATCH 1/2] Bugfix: Use the state of the button to set javascript

---
 badwolf.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/badwolf.c b/badwolf.c
index 003dda5..bfdde4c 100644
--- a/badwolf.c
+++ b/badwolf.c
@@ -131,13 +131,12 @@ static gboolean locationCb_activate(GtkEntry *location, gpointer user_data)
 
 static gboolean javascriptCb_toggled(GtkButton *javascript, gpointer user_data)
 {
-	(void)javascript;
 	struct Client *browser = (struct Client *)user_data;
 
 	WebKitSettings *settings = webkit_web_view_get_settings(browser->webView);
 
-	gboolean javascript_enabled = webkit_settings_get_enable_javascript(settings);
-	webkit_settings_set_enable_javascript(settings, !javascript_enabled);
+	webkit_settings_set_enable_javascript(
+	    settings, gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(javascript)));
 
 	webkit_web_view_set_settings(browser->webView, settings);
 
-- 
2.19.2

